{"code":"import { timeSinceLastFrame } from 'framesync';\r\nimport { number } from 'style-value-types';\r\nimport action from '../../action';\r\nimport vectorAction from '../../action/vector';\r\nimport { speedPerFrame } from '../../calc';\r\nimport onFrame from '../every-frame';\r\nvar physics = function (props) {\r\n    if (props === void 0) { props = {}; }\r\n    return action(function (_a) {\r\n        var complete = _a.complete, update = _a.update;\r\n        var _b = props.acceleration, acceleration = _b === void 0 ? 0 : _b, _c = props.friction, friction = _c === void 0 ? 0 : _c, _d = props.velocity, velocity = _d === void 0 ? 0 : _d, springStrength = props.springStrength, to = props.to;\r\n        var _e = props.restSpeed, restSpeed = _e === void 0 ? 0.001 : _e, _f = props.from, from = _f === void 0 ? 0 : _f;\r\n        var current = from;\r\n        var timer = onFrame().start(function () {\r\n            var elapsed = Math.max(timeSinceLastFrame(), 16);\r\n            if (acceleration)\r\n                velocity += speedPerFrame(acceleration, elapsed);\r\n            if (friction)\r\n                velocity *= Math.pow((1 - friction), (elapsed / 100));\r\n            if (springStrength !== undefined && to !== undefined) {\r\n                var distanceToTarget = to - current;\r\n                velocity += distanceToTarget * speedPerFrame(springStrength, elapsed);\r\n            }\r\n            current += speedPerFrame(velocity, elapsed);\r\n            update(current);\r\n            var isComplete = (restSpeed !== false && (!velocity || Math.abs(velocity) <= restSpeed));\r\n            if (isComplete) {\r\n                timer.stop();\r\n                complete();\r\n            }\r\n        });\r\n        return {\r\n            set: function (v) {\r\n                current = v;\r\n                return this;\r\n            },\r\n            setAcceleration: function (v) {\r\n                acceleration = v;\r\n                return this;\r\n            },\r\n            setFriction: function (v) {\r\n                friction = v;\r\n                return this;\r\n            },\r\n            setSpringStrength: function (v) {\r\n                springStrength = v;\r\n                return this;\r\n            },\r\n            setSpringTarget: function (v) {\r\n                to = v;\r\n                return this;\r\n            },\r\n            setVelocity: function (v) {\r\n                velocity = v;\r\n                return this;\r\n            },\r\n            stop: function () { return timer.stop(); }\r\n        };\r\n    });\r\n};\r\nexport default vectorAction(physics, {\r\n    acceleration: number.test,\r\n    friction: number.test,\r\n    velocity: number.test,\r\n    from: number.test,\r\n    to: number.test,\r\n    springStrength: number.test\r\n});\r\n//# sourceMappingURL=index.js.map","map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/animations/physics/index.ts\"],\"names\":[],\"mappings\":\"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\"}"}
