{"code":"import { onFrameUpdate, timeSinceLastFrame } from 'framesync';\r\nimport action from '../../action';\r\nimport { getProgressFromValue, getValueFromProgress } from '../../calc';\r\nimport { easeOut } from '../../easing';\r\nimport { clamp } from '../../transformers';\r\nimport onFrame from '../every-frame';\r\nimport scrubber from './scrubber';\r\nvar clampProgress = clamp(0, 1);\r\nvar tween = function (props) {\r\n    if (props === void 0) { props = {}; }\r\n    return action(function (_a) {\r\n        var update = _a.update, complete = _a.complete;\r\n        var _b = props.duration, duration = _b === void 0 ? 300 : _b, _c = props.ease, ease = _c === void 0 ? easeOut : _c, _d = props.flip, flip = _d === void 0 ? 0 : _d, _e = props.loop, loop = _e === void 0 ? 0 : _e, _f = props.yoyo, yoyo = _f === void 0 ? 0 : _f;\r\n        var _g = props.from, from = _g === void 0 ? 0 : _g, _h = props.to, to = _h === void 0 ? 1 : _h, _j = props.elapsed, elapsed = _j === void 0 ? 0 : _j, _k = props.playDirection, playDirection = _k === void 0 ? 1 : _k, _l = props.flipCount, flipCount = _l === void 0 ? 0 : _l, _m = props.yoyoCount, yoyoCount = _m === void 0 ? 0 : _m, _o = props.loopCount, loopCount = _o === void 0 ? 0 : _o;\r\n        var playhead = scrubber({ from: from, to: to, ease: ease }).start(update);\r\n        var progress = 0;\r\n        var tweenTimer;\r\n        var isActive = false;\r\n        var reverseTween = function () { return playDirection *= -1; };\r\n        var isTweenComplete = function () {\r\n            var _a;\r\n            var isComplete = (playDirection === 1)\r\n                ? isActive && elapsed >= duration\r\n                : isActive && elapsed <= 0;\r\n            if (!isComplete)\r\n                return false;\r\n            if (isComplete && !loop && !flip && !yoyo)\r\n                return true;\r\n            var isStepTaken = false;\r\n            if (loop && loopCount < loop) {\r\n                elapsed = 0;\r\n                loopCount++;\r\n                isStepTaken = true;\r\n            }\r\n            else if (flip && flipCount < flip) {\r\n                elapsed = duration - elapsed;\r\n                _a = [to, from], from = _a[0], to = _a[1];\r\n                playhead = scrubber({ from: from, to: to, ease: ease }).start(update);\r\n                flipCount++;\r\n                isStepTaken = true;\r\n            }\r\n            else if (yoyo && yoyoCount < yoyo) {\r\n                reverseTween();\r\n                yoyoCount++;\r\n                isStepTaken = true;\r\n            }\r\n            return !isStepTaken;\r\n        };\r\n        var updateTween = function () {\r\n            progress = clampProgress(getProgressFromValue(0, duration, elapsed));\r\n            playhead.seek(progress);\r\n        };\r\n        var startTimer = function () {\r\n            isActive = true;\r\n            tweenTimer = onFrame().start(function () {\r\n                elapsed += timeSinceLastFrame() * playDirection;\r\n                updateTween();\r\n                if (isTweenComplete() && complete) {\r\n                    tweenTimer.stop();\r\n                    onFrameUpdate(complete, true);\r\n                }\r\n            });\r\n        };\r\n        var stopTimer = function () {\r\n            isActive = false;\r\n            if (tweenTimer)\r\n                tweenTimer.stop();\r\n        };\r\n        startTimer();\r\n        return {\r\n            isActive: function () { return isActive; },\r\n            getElapsed: function () { return clamp(0, duration)(elapsed); },\r\n            getProgress: function () { return progress; },\r\n            stop: function () {\r\n                stopTimer();\r\n            },\r\n            pause: function () {\r\n                stopTimer();\r\n                return this;\r\n            },\r\n            resume: function () {\r\n                startTimer();\r\n                return this;\r\n            },\r\n            seek: function (newProgress) {\r\n                elapsed = getValueFromProgress(0, duration, newProgress);\r\n                onFrameUpdate(updateTween, true);\r\n                return this;\r\n            },\r\n            reverse: function () {\r\n                reverseTween();\r\n                return this;\r\n            }\r\n        };\r\n    });\r\n};\r\nexport default tween;\r\n//# sourceMappingURL=index.js.map","map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/animations/tween/index.ts\"],\"names\":[],\"mappings\":\"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\"}"}
